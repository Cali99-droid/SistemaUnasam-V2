obtenerDatos();let invitaciones=[],participaciones=[],derechos=[],beneficios=[],filtradas=[];async function obtenerDatos(){try{const e=obtenerIntegrante(),t=`http://appunasam.devor/integrante/getParticipaciones?id=${e}&idGrupo=${obtenerGrupo()}`,n=await fetch(t),a=await n.json();invitaciones=a.invitaciones,participaciones=a.participaciones,derechos=a.derechos,beneficios=a.beneficios,mostrarParticipaciones(),mostrarInvitaciones()}catch(e){console.log(e)}}function mostrarParticipaciones(){limpiar("#cuerpo-part");const e=document.getElementById("cuerpo-part");participaciones.forEach(t=>{const n=document.createElement("TR"),a=document.createElement("TD");a.textContent=t.nombreEvento;const i=document.createElement("TD");i.textContent=t.tipo;const o=document.createElement("TD"),c=document.createElement("BUTTON");c.classList.add("boton-asignar"),c.dataset.idParticipacion=t.id,c.ondblclick=function(){confirmarQuitarPart({...t})};const s=document.createElement("I");s.classList.add("fas"),s.classList.add("fa-minus-circle");const r=document.createElement("SPAN");r.textContent=" Quitar",c.appendChild(s),c.appendChild(r),o.appendChild(c),n.appendChild(a),n.appendChild(i),n.appendChild(o),e.appendChild(n)})}function confirmarQuitarPart(e){Swal.fire({title:"Eliminar participación?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(t=>{t.isConfirmed&&eliminarPart(e)})}async function eliminarPart(e){const{id:t}=e,n=new FormData;n.append("id",t);try{const t="http://appunasam.devor/integrante/deleteAsistencia",a=await fetch(t,{method:"POST",body:n}),i=await a.json();i&&(Swal.fire("Eliminado!",i.mensaje,"success"),participaciones=participaciones.filter(t=>t.id!==e.id),obtenerDatos(),mostrarParticipaciones(),console.log("hola"),clg)}catch(e){Swal.fire({icon:"error",title:"Error...",text:"Hubo un error al eliminar!"})}}function limpiar(e){const t=document.querySelector(e);for(;t.firstChild;)t.removeChild(t.firstChild)}function obtenerIntegrante(){return document.querySelector("#idAlumnoGrupo").value}function obtenerGrupo(){const e=new URLSearchParams(window.location.search);return grupo=Object.fromEntries(e.entries()),grupo.id}function mostrarInvitaciones(){limpiar("#cuerpo-inv");const e=document.getElementById("cuerpo-inv");invitaciones.forEach(t=>{const n=document.createElement("TR"),a=document.createElement("TD");a.textContent=t.evento;const i=document.createElement("TD");i.textContent=t.fecha_hora;const o=document.createElement("TD"),c=document.createElement("SPAN");c.classList.add("label"),c.textContent=t.est,o.appendChild(c);const s=document.createElement("TD");s.textContent=t.observacion;const r=document.createElement("TD"),d=document.createElement("BUTTON");d.classList.add("boton-asignar"),d.dataset.idInv=t.id,d.onclick=function(){asignarAsistencia({...t})};const l=document.createElement("I");l.classList.add("fas"),l.classList.add("fa-plus-circle");const p=document.createElement("SPAN");p.textContent=" Asignar Asistencia",d.appendChild(l),d.appendChild(p),r.appendChild(d),n.appendChild(a),n.appendChild(i),n.appendChild(o),n.appendChild(s),n.appendChild(r),e.appendChild(n)})}function asignarAsistencia(e){const t=document.getElementById("modal-asistencia");mostrarModal(t,document.getElementsByClassName("close-asis")[0]),t.addEventListener("click",(function(t){t.target.classList.contains("asignar-asis")&&crearAsistencia(e)}))}async function crearAsistencia(e){const t=document.querySelector("#tipo-part").value;datos=new FormData,idAl=obtenerIntegrante(),datos.append("invitacion_id",e.id),datos.append("alumno_x_grupo_id",idAl),datos.append("tipo",t);try{const t="http://appunasam.devor/integrante/setAsistencia",n=await fetch(t,{method:"POST",body:datos}),a=await n.json();if(a.tipo){Swal.fire("ÉXITO!",a.mensaje,"success");const t=document.querySelector("#modal-asistencia");setTimeout(()=>{t.style.display="none"},1e3);String(a.id),e.evento;obtenerDatos(),mostrarParticipaciones(),mostrarInvitaciones()}else Swal.fire("MENSAJE!",a.mensaje,"info")}catch(e){Swal.fire({icon:"error",title:"Error...",text:"Hubo un error al guardar la asistencia!"})}}function mostrarModal(e,t){e.style.display="block",t.onclick=function(){e.style.display="none"}}var slideIndex=1;function plusSlides(e){showSlides(slideIndex+=e)}function currentSlide(e){showSlides(slideIndex=e)}function showSlides(e){var t,n=document.getElementsByClassName("mySlides"),a=document.getElementsByClassName("btn-slide");for(e>n.length&&(slideIndex=1),e<1&&(slideIndex=n.length),t=0;t<n.length;t++)n[t].style.display="none";for(t=0;t<a.length;t++)a[t].className=a[t].className.replace(" active","");n[slideIndex-1].style.display="block",a[slideIndex-1].className+=" active"}showSlides(slideIndex);