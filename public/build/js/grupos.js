obtenerGrupos();let grupos=[],filtradas=[];const busqueda=document.querySelector("#nom");busqueda.addEventListener("keyup",buscarGrupo);const crearGrup=document.querySelector("#boton-agregar-grupo");function buscarGrupo(e){const t=e.target.value;filtradas=findMatches(t,grupos),mostrarGrupos()}function findMatches(e,t){return t.filter(t=>{const o=new RegExp(e,"gi");return t.nombre.match(o)||t.tipo.nombre.match(o)})}async function obtenerGrupos(){try{const e="api/grupos",t=await fetch(e),o=await t.json();grupos=o.grupos,mostrarGrupos(!0)}catch(e){console.log(e)}}function mostrarGrupos(e=!1){e&&grupos.reverse(),limpiarGrupos();const t=filtradas.length?filtradas:grupos;if(0===t.length)return void console.log("no hay grupos");const o=document.querySelector("#contenedor-grupos");t.forEach(e=>{const t=document.createElement("DIV");t.dataset.grupoId=e.id,t.classList.add("grupo");const n=document.createElement("A");n.setAttribute("href","/grupo?id="+e.id);const r=document.createElement("IMG");r.setAttribute("src","/imagenes/"+e.imagen),r.classList.add("grupo-imagen");const c=document.createElement("DIV");c.classList.add("container");const a=document.createElement("H4");a.classList.add("no-margin"),a.textContent=e.nombre;const s=document.createElement("P");s.textContent=e.tipo.nombre;const i=document.createElement("P");i.textContent="Integrantes:  "+e.cantidad_integrantes,c.appendChild(a),c.appendChild(s),c.appendChild(i),n.appendChild(r),n.appendChild(c),t.appendChild(n),o.appendChild(t)})}function limpiarGrupos(){const e=document.querySelector("#contenedor-grupos");for(;e.firstChild;)e.removeChild(e.firstChild)}function mostrarForm(e={}){const t=document.getElementById("modal-grupo"),o=document.getElementsByClassName("close-grupo")[0];t.style.display="block",o.onclick=function(){t.style.display="none"},t.addEventListener("click",(function(t){if(t.target.classList.contains("crearGrupo")){const t=document.querySelector("#nombre-grupo").value.trim(),o=document.querySelector("#fecha_creacion").value,n=document.querySelector("#resolucion").value,r=document.querySelector("#tipo_grupo_id").value,c=document.querySelector("#imagen");e.nombre=t,e.fecha_creacion=o,e.resolucion=n,e.tipo_grupo_id=r,e.imagen=c.files[0],crearGrupo(e)}}))}async function crearGrupo(e){const t=new FormData;t.append("nombre",e.nombre),t.append("fecha_creacion",e.fecha_creacion),t.append("resolucion_creacion",e.resolucion),t.append("tipo_grupo_id",e.tipo_grupo_id),t.append("imagen",e.imagen);try{const o="http://localhost:3000/grupos",n=await fetch(o,{method:"POST",body:t}),r=await n.json();if(Swal.fire("Ã‰XITO",r.mensaje,"success"),"exito"==r.tipo){const t=document.querySelector("#modal-grupo");setTimeout(()=>{t.style.display="none"},1e3);const o={id:String(r.id),nombre:e.nombre,tipo:String(r.tipo_grupo.nombre),cantidad_integrantes:String(r.cantidad_integrantes),imagen:String(r.imagen)};grupos.unshift(o),mostrarGrupos()}}catch(e){console.log(e)}}crearGrup.addEventListener("click",mostrarForm);